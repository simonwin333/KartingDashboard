<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Karting Dashboard - Suivi de Performance</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <!-- En-tÃªte -->
        <header>
            <div class="header-content">
                <div class="header-left">
                    <h1>ğŸ Karting Dashboard</h1>
                    <p class="header-subtitle">Suivez vos performances sur circuit</p>
                    <p class="header-pilot-info">
                        <span id="headerPilotName">-</span> â€¢ 
                        <span id="headerKartType">-</span> â€¢ 
                        <span id="headerKartEngine">-</span>
                    </p>
                </div>
                <div class="header-buttons">
                    <button class="header-btn-small" onclick="dashboard.switchView('settings')" title="RÃ©glages">âš™ï¸</button>
                </div>
            </div>
        </header>

        <!-- Menu de navigation -->
        <nav class="main-nav">
            <button class="nav-btn active" data-view="dashboard">ğŸ  Dashboard</button>
            <button class="nav-btn" data-view="add-session">â• Session</button>
            <button class="nav-btn" data-view="statistics">ğŸ“Š Circuits</button>
            <button class="nav-btn" data-view="history">ğŸ“‹ Historique</button>
        </nav>

        <!-- Modal Connexion Firebase -->
        <div class="auth-modal" id="authModal" style="display: none;">
            <div class="auth-modal-content">
                <div class="auth-modal-header">
                    <h3>ğŸ” Connexion / Inscription</h3>
                    <button class="modal-close-btn" onclick="dashboard.closeAuthModal()">âœ•</button>
                </div>
                <div class="auth-modal-body">
                    <p style="color: #999; margin-bottom: 20px; font-size: 0.9em;">
                        Connectez-vous pour synchroniser vos donnÃ©es sur tous vos appareils
                    </p>

                    <button class="btn-google-signin" id="googleSignInBtn">
                        <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google" style="width: 18px; margin-right: 8px;">
                        Continuer avec Google
                    </button>

                    <div class="divider">
                        <span>OU</span>
                    </div>

                    <form id="authForm">
                        <div class="form-group">
                            <label for="authEmail">E-mail :</label>
                            <input type="email" id="authEmail" required placeholder="votre@email.com">
                        </div>
                        <div class="form-group">
                            <label for="authPassword">Mot de passe :</label>
                            <input type="password" id="authPassword" required placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" minlength="6">
                        </div>
                        <button type="submit" class="btn-primary" id="authSubmitBtn">Se connecter</button>
                        <button type="button" class="btn-secondary" id="authToggleBtn">CrÃ©er un compte</button>
                    </form>

                    <p style="color: #666; font-size: 0.8em; margin-top: 15px;">
                        ğŸ”’ Vos donnÃ©es restent privÃ©es et sÃ©curisÃ©es
                    </p>
                </div>
            </div>
        </div>

        <!-- Dashboard - Page d'accueil -->
        <section class="dashboard-home view-section" data-view="dashboard">
            
            <!-- Statistiques principales en grille -->
            <div class="dashboard-stats-grid">
                <div class="stat-box">
                    <div class="stat-icon">ğŸ“Š</div>
                    <div class="stat-content">
                        <div class="stat-label">Sessions totales</div>
                        <div class="stat-value" id="dashTotalSessions">0</div>
                    </div>
                </div>
                <div class="stat-box">
                    <div class="stat-icon">ğŸ†</div>
                    <div class="stat-content">
                        <div class="stat-label">Circuit prÃ©fÃ©rÃ©</div>
                        <div class="stat-value" id="dashFavoriteCircuit">-</div>
                        <div class="stat-subvalue" id="dashFavoriteCircuitBest">-</div>
                    </div>
                </div>
                <div class="stat-box">
                    <div class="stat-icon">ğŸ</div>
                    <div class="stat-content">
                        <div class="stat-label">Circuits visitÃ©s</div>
                        <div class="stat-value" id="dashCircuitsCount">0</div>
                    </div>
                </div>
                <div class="stat-box">
                    <div class="stat-icon">ğŸ”¢</div>
                    <div class="stat-content">
                        <div class="stat-label">Tours totaux</div>
                        <div class="stat-value" id="dashTotalLaps">0</div>
                    </div>
                </div>
            </div>

            <!-- DerniÃ¨res sessions -->
            <div class="recent-sessions">
                <h3>ğŸ“… DerniÃ¨res sessions</h3>
                <div id="recentSessionsList"></div>
            </div>
        </section>

        <!-- Page Ajouter Session -->
        <section class="add-session-page view-section" data-view="add-session" style="display: none;">
            <h2>â• Ajouter une session</h2>
            <form id="sessionForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="date">Date :</label>
                        <input type="date" id="date" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="time">Heure :</label>
                        <input type="time" id="time" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="circuit">Circuit :</label>
                    <select id="circuit" required>
                        <option value="">-- SÃ©lectionnez un circuit --</option>
                    </select>
                    <button type="button" class="btn-add-circuit" id="addCircuitBtn">â• Ajouter un nouveau circuit</button>
                </div>
                
                <div class="form-group">
                    <label for="bestTime">Meilleur temps (secondes) :</label>
                    <input type="number" id="bestTime" step="0.001" placeholder="Ex: 45.234" required>
                </div>

                <div class="form-group">
                    <label for="lapsCount">Nombre de tours :</label>
                    <input type="number" id="lapsCount" min="1" placeholder="Ex: 15" required>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="maxLaps">Tours minutes moteur (max) :</label>
                        <input type="number" id="maxLaps" min="1" placeholder="Ex: 15000">
                    </div>

                    <div class="form-group">
                        <label for="crownUsed">Couronne utilisÃ©e :</label>
                        <input type="text" id="crownUsed" placeholder="Ex: 11/75">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="weather">MÃ©tÃ©o :</label>
                        <select id="weather" required>
                            <option value="">-- SÃ©lectionnez --</option>
                            <option value="Sec â˜€ï¸">Sec â˜€ï¸</option>
                            <option value="Nuageux â›…">Nuageux â›…</option>
                            <option value="Pluie ğŸŒ§ï¸">Pluie ğŸŒ§ï¸</option>
                            <option value="Pluie forte ğŸŒ§ï¸âš¡">Pluie forte ğŸŒ§ï¸âš¡</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="temperature">TempÃ©rature (Â°C) :</label>
                        <input type="number" id="temperature" placeholder="Ex: 18">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="tireType">Type de pneus :</label>
                        <select id="tireType" required>
                            <option value="">-- SÃ©lectionnez --</option>
                            <option value="Tendres">Tendres (soft)</option>
                            <option value="MÃ©diums">MÃ©diums</option>
                            <option value="Durs">Durs (hard)</option>
                            <option value="Pluie">Pluie</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="tirePressure">Pression pneus (bar) :</label>
                        <input type="number" id="tirePressure" step="0.01" placeholder="Ex: 0.85">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="notes">Notes (optionnel) :</label>
                    <textarea id="notes" rows="3" placeholder="Sensations, rÃ©glages chÃ¢ssis, trajectoires..."></textarea>
                </div>
                
                <button type="submit" class="btn-primary" id="submitBtn">ğŸ“Š Enregistrer la session</button>
                <button type="button" class="btn-cancel" id="cancelEditBtn" style="display: none;">âŒ Annuler la modification</button>
            </form>
        </section>

        <!-- Page Profil -->
        <section class="profile-page view-section" data-view="profile" style="display: none;">
            <h2>ğŸ‘¤ Profil du pilote</h2>
            
            <form id="profileForm" class="profile-form">
                <div class="form-group">
                    <label for="pilotName">Nom du pilote :</label>
                    <input type="text" id="pilotName" placeholder="Ex: Simon Dupont">
                </div>

                <div class="form-group">
                    <label for="kartType">Type de kart :</label>
                    <input type="text" id="kartType" placeholder="Ex: CRG Road Rebel">
                </div>

                <div class="form-group">
                    <label for="kartEngine">Moteur :</label>
                    <input type="text" id="kartEngine" placeholder="Ex: Rotax Max">
                </div>

                <button type="submit" class="btn-primary">ğŸ’¾ Sauvegarder le profil</button>
            </form>
        </section>

        <!-- Page RÃ©glages (avec Profil fusionnÃ©) -->
        <section class="settings-page view-section" data-view="settings" style="display: none;">
            <h2>âš™ï¸ RÃ©glages</h2>
            
            <!-- Section Profil -->
            <div class="settings-section">
                <h3>ğŸ‘¤ Profil du pilote</h3>
                <form id="profileForm" class="profile-form">
                    <div class="form-group">
                        <label for="pilotName">Nom du pilote :</label>
                        <input type="text" id="pilotName" placeholder="Ex: Simon Dupont">
                    </div>

                    <div class="form-group">
                        <label for="kartType">Type de kart :</label>
                        <input type="text" id="kartType" placeholder="Ex: CRG Road Rebel">
                    </div>

                    <div class="form-group">
                        <label for="kartEngine">Moteur :</label>
                        <input type="text" id="kartEngine" placeholder="Ex: Rotax Max">
                    </div>

                    <button type="submit" class="btn-primary">ğŸ’¾ Sauvegarder le profil</button>
                </form>
            </div>
            
            <!-- Section Apparence -->
            <div class="settings-section">
                <h3>ğŸ¨ Apparence</h3>
                
                <div class="form-group">
                    <label for="themeMode">Mode :</label>
                    <select id="themeMode">
                        <option value="dark">ğŸŒ™ Sombre (par dÃ©faut)</option>
                        <option value="light">â˜€ï¸ Clair</option>
                    </select>
                    <p style="color: #999; font-size: 0.85em; margin-top: 8px;">Le thÃ¨me s'applique automatiquement</p>
                </div>
            </div>

            <!-- Section Compte -->
            <div class="settings-section">
                <h3>ğŸ” Compte</h3>
                <button class="btn-secondary" id="logoutBtn" style="width: 100%;">ğŸšª Se dÃ©connecter</button>
                <p style="color: #999; margin-top: 10px; font-size: 0.9em;">Vous serez redirigÃ© vers la page de connexion</p>
            </div>

            <!-- Section DonnÃ©es -->
            <div class="settings-section">
                <h3>ğŸ’¾ DonnÃ©es</h3>
                <button class="btn-danger" id="clearAllData">ğŸ—‘ï¸ Effacer toutes les donnÃ©es</button>
                <p style="color: #999; margin-top: 10px; font-size: 0.9em;">âš ï¸ Attention : Cette action est irrÃ©versible !</p>
            </div>

            <!-- Section Ã€ propos -->
            <div class="settings-section">
                <h3>â„¹ï¸ Ã€ propos</h3>
                <p style="color: #999;">Version 3.1</p>
                <p style="color: #999;">DÃ©veloppÃ© par Simon avec Claude AI</p>
            </div>
        </section>

        <!-- Section des statistiques par circuit -->
        <section class="stats view-section" data-view="statistics" style="display: none;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2 style="margin: 0;">ğŸ“Š Analyse par Circuit</h2>
                <div>
                    <select id="circuitFilter" class="circuit-filter">
                        <option value="all">Tous les circuits</option>
                    </select>
                </div>
            </div>
            <div id="circuitsAnalysis"></div>
        </section>

        <!-- Liste des sessions -->
        <section class="sessions-list view-section" data-view="history" style="display: none;">
            <h2>ğŸ“‹ Historique des sessions</h2>
            <div id="sessionsList"></div>
        </section>

        <!-- Modal dÃ©tails session -->
        <div class="session-modal" id="sessionModal">
            <div class="session-modal-content">
                <div class="session-modal-header">
                    <h3>ğŸ“Š DÃ©tails de la session</h3>
                    <button class="modal-close-btn" onclick="dashboard.closeSessionDetails()">âœ•</button>
                </div>
                <div id="sessionDetailsContent"></div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- App principal -->
    <script src="app.js"></script>
</body>
</html>
